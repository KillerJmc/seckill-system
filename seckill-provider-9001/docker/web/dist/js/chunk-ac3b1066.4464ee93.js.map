{"version":3,"sources":["webpack:///./src/auth/token.js","webpack:///./node_modules/js-cookie/dist/js.cookie.js","webpack:///./src/const/msg-mapping.js","webpack:///./src/assets/css/seckill.css?7ddb","webpack:///./src/views/Seckill.vue","webpack:///./src/components/CountDown.vue","webpack:///./src/components/CountDown.vue?4083","webpack:///./src/views/Seckill.vue?b93c"],"names":["Token","Cookies","get","Const","TOKEN_NAME","undefined","this","alert","MsgMapping","NOT_LOGGED_ON","global","factory","module","exports","assign","target","i","arguments","length","source","key","defaultConverter","read","value","slice","replace","decodeURIComponent","write","encodeURIComponent","init","converter","defaultAttributes","set","attributes","document","expires","Date","now","toUTCString","escape","stringifiedAttributes","attributeName","split","cookie","cookies","jar","parts","join","foundKey","e","Object","create","remove","withAttributes","withConverter","freeze","api","path","ACCOUNT_PWD_NULL_OR_EMPTY","ACCOUNT_OR_PWD_ERROR","ACCOUNT_MUST_BE_DIGITS","LOGIN_SUCCESS","NAME_ID_NUM_PWD_NULL_OR_EMPTY","ENTER_TWICE_PWD_MISMATCH","ID_NUM_REPEATED","REG_SUCCESS","ID_NUM_FORMAT_ERROR","LOGIN_REPEAT","APPLY_SUCCESS","APPLY_FAILED","APPLY_REPEAT","DOES_NOT_APPLY","SECKILL_NOT_STARTED","SECKILL_ENDED","PRODUCT_SOLD_OUT","PURCHASE_REPEAT","INVALID_SECKILL_URL","SECKILL_SUCCESS","class","customer","name","gotoOrderPage","activity","product","amount","countDown","display","remain-time","remainSeconds","countDownEnd","seckillButton","enableSeckillButton","order","orderId","orderPrice","payOrderButton","hourString","minuteString","secondString","data","hour","minute","second","timer","props","remainTime","default","mounted","Math","floor","$emit","methods","self","clearInterval","setInterval","formatNum","num","computed","__exports__","components","CountDown","applied","startTime","info","end","seckillUrl","verify","$router","push","$store","dispatch","customerInfo","activityInfo","code","countDownData","enableSeckillButtonLoop","res","console","log","orderData","render"],"mappings":"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","file":"js/chunk-ac3b1066.4464ee93.js","sourcesContent":["import Cookies from \"js-cookie\";\r\nimport Const from \"@/const/const\";\r\nimport MsgMapping from \"@/const/msg-mapping\";\r\n\r\nexport class Token {\r\n  static get() {\r\n    return Cookies.get(Const.TOKEN_NAME)\r\n  }\r\n\r\n  static verify() {\r\n    if (this.get() === undefined) {\r\n      alert(MsgMapping.NOT_LOGGED_ON)\r\n      return false\r\n    }\r\n    return true\r\n  }\r\n}\r\n","/*! js-cookie v3.0.1 | MIT */\n;\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, (function () {\n    var current = global.Cookies;\n    var exports = global.Cookies = factory();\n    exports.noConflict = function () { global.Cookies = current; return exports; };\n  }()));\n}(this, (function () { 'use strict';\n\n  /* eslint-disable no-var */\n  function assign (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        target[key] = source[key];\n      }\n    }\n    return target\n  }\n  /* eslint-enable no-var */\n\n  /* eslint-disable no-var */\n  var defaultConverter = {\n    read: function (value) {\n      if (value[0] === '\"') {\n        value = value.slice(1, -1);\n      }\n      return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n    },\n    write: function (value) {\n      return encodeURIComponent(value).replace(\n        /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n        decodeURIComponent\n      )\n    }\n  };\n  /* eslint-enable no-var */\n\n  /* eslint-disable no-var */\n\n  function init (converter, defaultAttributes) {\n    function set (key, value, attributes) {\n      if (typeof document === 'undefined') {\n        return\n      }\n\n      attributes = assign({}, defaultAttributes, attributes);\n\n      if (typeof attributes.expires === 'number') {\n        attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n      }\n      if (attributes.expires) {\n        attributes.expires = attributes.expires.toUTCString();\n      }\n\n      key = encodeURIComponent(key)\n        .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n        .replace(/[()]/g, escape);\n\n      var stringifiedAttributes = '';\n      for (var attributeName in attributes) {\n        if (!attributes[attributeName]) {\n          continue\n        }\n\n        stringifiedAttributes += '; ' + attributeName;\n\n        if (attributes[attributeName] === true) {\n          continue\n        }\n\n        // Considers RFC 6265 section 5.2:\n        // ...\n        // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n        //     character:\n        // Consume the characters of the unparsed-attributes up to,\n        // not including, the first %x3B (\";\") character.\n        // ...\n        stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n      }\n\n      return (document.cookie =\n        key + '=' + converter.write(value, key) + stringifiedAttributes)\n    }\n\n    function get (key) {\n      if (typeof document === 'undefined' || (arguments.length && !key)) {\n        return\n      }\n\n      // To prevent the for loop in the first place assign an empty array\n      // in case there are no cookies at all.\n      var cookies = document.cookie ? document.cookie.split('; ') : [];\n      var jar = {};\n      for (var i = 0; i < cookies.length; i++) {\n        var parts = cookies[i].split('=');\n        var value = parts.slice(1).join('=');\n\n        try {\n          var foundKey = decodeURIComponent(parts[0]);\n          jar[foundKey] = converter.read(value, foundKey);\n\n          if (key === foundKey) {\n            break\n          }\n        } catch (e) {}\n      }\n\n      return key ? jar[key] : jar\n    }\n\n    return Object.create(\n      {\n        set: set,\n        get: get,\n        remove: function (key, attributes) {\n          set(\n            key,\n            '',\n            assign({}, attributes, {\n              expires: -1\n            })\n          );\n        },\n        withAttributes: function (attributes) {\n          return init(this.converter, assign({}, this.attributes, attributes))\n        },\n        withConverter: function (converter) {\n          return init(assign({}, this.converter, converter), this.attributes)\n        }\n      },\n      {\n        attributes: { value: Object.freeze(defaultAttributes) },\n        converter: { value: Object.freeze(converter) }\n      }\n    )\n  }\n\n  var api = init(defaultConverter, { path: '/' });\n  /* eslint-enable no-var */\n\n  return api;\n\n})));\n","export default {\r\n  // 账号或密码为空\r\n  ACCOUNT_PWD_NULL_OR_EMPTY: \"账号或密码为空\",\r\n\r\n  // 账号或密码错误\r\n  ACCOUNT_OR_PWD_ERROR: \"账号或密码错误\",\r\n\r\n  // 账号必须为纯数字\r\n  ACCOUNT_MUST_BE_DIGITS: \"账号id必须为纯数字！\",\r\n\r\n  // 登录成功\r\n  LOGIN_SUCCESS: \"登录成功\",\r\n\r\n  // 姓名，身份证或密码为空\r\n  NAME_ID_NUM_PWD_NULL_OR_EMPTY: \"姓名，身份证或密码为空\",\r\n\r\n  // 两次输入的密码不匹配\r\n  ENTER_TWICE_PWD_MISMATCH: \"两次输入的密码不匹配！\",\r\n\r\n  // 身份证号重复\r\n  ID_NUM_REPEATED: \"身份证号重复\",\r\n\r\n  // 注册成功\r\n  REG_SUCCESS: \"注册成功\",\r\n\r\n  // 身份证号格式错误\r\n  ID_NUM_FORMAT_ERROR: \"身份证号格式错误\",\r\n\r\n  // 重复登录\r\n  LOGIN_REPEAT: \"重复登录\",\r\n\r\n  // 未登录\r\n  NOT_LOGGED_ON: \"您还未登录\",\r\n\r\n  // 活动申请成功\r\n  APPLY_SUCCESS: \"申请成功\",\r\n\r\n  // 活动申请失败\r\n  APPLY_FAILED: \"申请失败，您不符合申请条件\",\r\n\r\n  // 重复申请\r\n  APPLY_REPEAT: \"重复申请\",\r\n\r\n  // 没有申请活动\r\n  DOES_NOT_APPLY: \"没有申请活动\",\r\n\r\n  // 秒杀活动还未开始\r\n  SECKILL_NOT_STARTED: \"秒杀活动还未开始\",\r\n\r\n  // 秒杀活动已经结束\r\n  SECKILL_ENDED: \"秒杀活动已经结束\",\r\n\r\n  // 商品已经售完\r\n  PRODUCT_SOLD_OUT: \"商品已经售完\",\r\n\r\n  // 重复购买\r\n  PURCHASE_REPEAT: \"重复购买\",\r\n\r\n  // 秒杀链接错误\r\n  INVALID_SECKILL_URL: \"秒杀链接错误\",\r\n\r\n  // 秒杀成功\r\n  SECKILL_SUCCESS: \"秒杀成功\"\r\n}\r\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!./seckill.css?vue&type=style&index=0&id=1e3cdfee&scoped=true&lang=css\"","<template>\n  <div>\n    <div class=\"header\">\n      <div class=\"left-block\"></div>\n      <div class=\"title\">\n        <div class=\"title-logo\"></div>\n      </div>\n      <div class=\"right-block\"></div>\n      <div class=\"account-bar\">\n        <div class=\"account-info\">\n        </div>\n        <div class=\"account-name\">{{ customer.name }}</div>\n      </div>\n    </div>\n\n    <div class=\"content\">\n      <div class=\"seckill-form\" v-if=\"!gotoOrderPage\">\n        <div class=\"information\">\n          {{ activity.product.name }} <br><br>\n          库存总量：{{ activity.amount }}份\n        </div>\n        <div class=\"time\">\n          活动倒计时:\n          <count-down v-if=\"countDown.display\" :remain-time=\"countDown.remainSeconds\" @count-down-end=\"countDownEnd\"/>\n        </div>\n        <div class=\"button-view\">\n          <button @click=\"seckillButton\" :class=\"{'enter-button': true, 'disabled': !enableSeckillButton}\">秒杀</button>\n        </div>\n      </div>\n\n      <div class=\"seckill-success-form\" v-if=\"gotoOrderPage\">\n        <div class=\"order-info-title\">订单信息</div>\n        <div class=\"order-info\">\n          订单编号：{{ order.orderId }}<br>\n          订单金额：{{ order.orderPrice }}元\n        </div>\n        <div class=\"button-view\">\n          <button @click=\"payOrderButton\" class=\"enter-button\">付款</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport MsgMapping from \"@/const/msg-mapping\";\n\nimport CountDown from \"@/components/CountDown\";\nimport { Token } from \"@/auth/token\";\n\nexport default {\n  name: \"Seckill\",\n  components: {\n    // 倒计时组件\n    CountDown\n  },\n  data: () => {\n    return {\n      // 客户信息\n      customer: {\n        // 客户姓名\n        name: '',\n        // 是否申请过活动\n        applied: false,\n      },\n\n      // 活动信息\n      activity: {\n        // 开始时间\n        startTime: '',\n        // 商品信息\n        product: {\n          // 商品名称\n          name: '',\n          // 商品介绍\n          info: '',\n        },\n        // 库存总量\n        amount: 0\n      },\n\n      // 秒杀倒计时\n      countDown: {\n        // 是否显示\n        display: false,\n        // 剩余时间（秒）\n        remainSeconds: 0,\n        // 是否结束\n        end: false\n      },\n\n      // 秒杀链接\n      seckillUrl: '',\n\n      // 是否前往订单页面\n      gotoOrderPage: false,\n\n      // 订单信息\n      order: {\n        // 订单id\n        orderId: '',\n        // 订单价格\n        orderPrice: 0\n      }\n    }\n  },\n  async mounted() {\n    // 如果没有token就跳转登录\n    if (!Token.verify()) {\n      await this.$router.push('/');\n    }\n\n    // 请求客户信息\n    let customerInfo = await this.$store.dispatch('customer/getInfo')\n\n    // 请求当前秒杀活动信息\n    let activityInfo = await this.$store.dispatch('activity/getCurrent')\n\n    // 如果请求失败就返回主页\n    if (customerInfo.code !== 200 || activityInfo.code !== 200) {\n      await this.$router.push('/');\n    }\n\n    // 填充客户信息\n    this.customer = customerInfo.data\n\n    // 填充秒杀活动信息\n    this.activity = activityInfo.data.activity\n\n    // 如果没有申请活动就返回申请页面\n    if (!this.customer.applied) {\n      alert(MsgMapping.DOES_NOT_APPLY)\n      await this.$router.push('/apply')\n      return\n    }\n\n    // 获取倒计时秒数\n    let countDownData = await this.$store.dispatch('activity/getCountDown')\n    // 初始化倒计时\n    this.countDown.remainSeconds = countDownData.data.countDown\n    // 展示倒计时\n    this.countDown.display = true\n\n    // 每秒获取一次秒杀链接，获取到之后使按钮亮起开启秒杀\n    let self = this\n    let enableSeckillButtonLoop = setInterval(async () => {\n      let res = await this.$store.dispatch('activity/getSeckillUrl')\n      if (res.code === 200) {\n        self.seckillUrl = res.data.seckillUrl\n        console.log('获取到秒杀链接：' + self.seckillUrl)\n        clearInterval(enableSeckillButtonLoop)\n      }\n    }, 1000)\n  },\n  methods: {\n    async seckillButton() {\n      // 秒杀按钮未开启就提示信息\n      if (!this.enableSeckillButton) {\n        await alert(MsgMapping.SECKILL_NOT_STARTED)\n        return\n      }\n\n      // 尝试秒杀并获取订单\n      let orderData = await this.$store.dispatch('activity/seckill', this.seckillUrl)\n\n      // 请求失败就结束\n      if (orderData.code === 500) {\n        return\n      }\n\n      // 展示订单信息\n      this.order = orderData.data.order\n\n      // 展示秒杀成功对话框\n      await alert(MsgMapping.SECKILL_SUCCESS)\n\n      // 前往订单页面\n      this.gotoOrderPage = true\n    },\n    // 支付订单按钮\n    payOrderButton() {\n      alert(\"已从您绑定的默认本行卡中扣取款项，支付成功！\")\n    },\n    // 倒计时结束\n    countDownEnd() {\n      this.countDown.end = true\n    }\n  },\n  computed: {\n    // 是否开启秒杀按钮\n    enableSeckillButton() {\n      // 开启秒杀按钮的条件是客户已经得到秒杀id且倒计时结束\n      return this.seckillUrl !== '' && this.countDown.end\n    }\n  }\n}\n</script>\n\n<style src=\"../assets/css/seckill.css\" scoped/>\n\n","<template>\r\n  <span>{{hourString+':'+minuteString+':'+secondString}}</span>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"CountDown\",\r\n  data () {\r\n    return {\r\n      hour: '',\r\n      minute: '',\r\n      second: '',\r\n      timer: ''\r\n    }\r\n  },\r\n  props: {\r\n    // 倒计时间总秒数\r\n    remainTime: {\r\n      default: ''\r\n    }\r\n  },\r\n  mounted () {\r\n    if (this.remainTime > 0) {\r\n      this.hour = Math.floor((this.remainTime / 3600) % 24)\r\n      this.minute = Math.floor((this.remainTime / 60) % 60)\r\n      this.second = Math.floor(this.remainTime % 60)\r\n      this.countDown()\r\n      return\r\n    }\r\n    // 发送倒计时结束信号\r\n    this.$emit(\"count-down-end\")\r\n  },\r\n  methods: {\r\n    countDown () {\r\n      let self = this\r\n      clearInterval(this.timer)\r\n      this.timer = setInterval(function () {\r\n        if (self.hour === 0) {\r\n          if (self.minute !== 0 && self.second === 0) {\r\n            self.second = 59\r\n            self.minute -= 1\r\n          } else if (self.minute === 0 && self.second === 0) {\r\n            self.second = 0\r\n            // 发送倒计时结束信号\r\n            self.$emit(\"count-down-end\")\r\n            clearInterval(self.timer)\r\n          } else {\r\n            self.second -= 1\r\n          }\r\n        } else {\r\n          if (self.minute !== 0 && self.second === 0) {\r\n            self.second = 59\r\n            self.minute -= 1\r\n          } else if (self.minute === 0 && self.second === 0) {\r\n            self.hour -= 1\r\n            self.minute = 59\r\n            self.second = 59\r\n          } else {\r\n            self.second -= 1\r\n          }\r\n        }\r\n      }, 1000)\r\n    },\r\n    formatNum (num) {\r\n      return num < 10 ? '0' + num : '' + num\r\n    }\r\n  },\r\n  computed: {\r\n    hourString () {\r\n      return this.formatNum(this.hour)\r\n    },\r\n    minuteString () {\r\n      return this.formatNum(this.minute)\r\n    },\r\n    secondString () {\r\n      return this.formatNum(this.second)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>","import { render } from \"./CountDown.vue?vue&type=template&id=25381f8b\"\nimport script from \"./CountDown.vue?vue&type=script&lang=js\"\nexport * from \"./CountDown.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\Jmc\\\\Desktop\\\\seckill-system-web-test\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Seckill.vue?vue&type=template&id=1e3cdfee&scoped=true\"\nimport script from \"./Seckill.vue?vue&type=script&lang=js\"\nexport * from \"./Seckill.vue?vue&type=script&lang=js\"\n\nimport \"../assets/css/seckill.css?vue&type=style&index=0&id=1e3cdfee&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\Jmc\\\\Desktop\\\\seckill-system-web-test\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1e3cdfee\"]])\n\nexport default __exports__"],"sourceRoot":""}